group=20
grpSize <- ceiling(length(OD_pvalue)/group)
probVec <- sapply(1:group, fun_prob)
probVec
group=30
group=30
grpSize <- ceiling(length(OD_pvalue)/group)
probVec <- sapply(1:group, fun_prob)
probVec
group=40
grpSize <- ceiling(length(OD_pvalue)/group)
probVec <- sapply(1:group, fun_prob)
probVec
group=50
grpSize <- ceiling(length(OD_pvalue)/group)
probVec <- sapply(1:group, fun_prob)
probVec
group=60
grpSize <- ceiling(length(OD_pvalue)/group)
probVec <- sapply(1:group, fun_prob)
probVec
group=70
grpSize <- ceiling(length(OD_pvalue)/group)
probVec <- sapply(1:group, fun_prob)
probVec
group=100
grpSize <- ceiling(length(OD_pvalue)/group)
probVec <- sapply(1:group, fun_prob)
probVec
probVec_smooth <- smooth.spline(x = 1:group, y = probVec, cv = FALSE)$y
ham_res <- empOPW(pvalue = pvals, filter = filters, alpha = .1, tail = 2,
delInterval = .01, max.group = 100,
effectType = "continuous", method = "BH")
ham_res$rejections
ham_res$opGroup
rm(list=ls())
load(system.file("extdata/real_data", "hammer_eset.RData", package = "IHWpaper"),
envir=environment())
countData <- exprs(hammer.eset)
colData <- pData(hammer.eset)
dds <- DESeqDataSetFromMatrix(countData = countData, colData = colData , design = ~protocol)
dds <- dds[, dds$Time == "2 months"]
dds <- DESeq(dds)
de_res_ham <- results(dds)
colnames(de_res_ham)
dim(de_res_ham)
filters = de_res_ham$baseMean
pvals <- de_res_ham$pvalue
m = length(pvals)
ham_res <- empOPW(pvalue = pvals, filter = filters, alpha = .1, tail = 2,
delInterval = .01, max.group = 100,
effectType = "continuous", method = "BH")
ham_res$rejections
ham_res$opGroup
ham_res <- empOPW(pvalue = pvals, filter = filters, alpha = .1, tail = 2,
delInterval = .01, max.group = 100,
effectType = "continuous", method = "BON")
ham_res$rejections
ham_res$opGroup
X = runif(1000, min = 0, max = 2)         # covariate
bin_idx = 1L
h_breaks = 20L
obs = X
bin <- c(0, (1:h_breaks)/h_breaks)
bin
bin.counts <- tabulate(cut(obs, bin))
bin.counts
bin.counts[5] <- 0
bin.counts
bin.counts/sum(bin.counts)
sum(bin.counts)
rel_freq_all = bin.counts/sum(bin.counts)
rel_freq_all
1:h_breaks
h_breaks
c(0, (1:h_breaks)/h_breaks)
TG_ONE_Eur_tbl <- read_delim("TG_ONE_Eur.tbl.sorted","\t", escape_double = FALSE, trim_ws = TRUE)
setwd("U:/Documents/My Research (UGA)/Multiple Hypoetheses/Article-2")
library(readr)
TG_ONE_Eur_tbl <- read_delim("TG_ONE_Eur.tbl.sorted","\t", escape_double = FALSE, trim_ws = TRUE)
pgc_scz_full_2012_04 <- read.table("pgc.scz.full.2012-04.txt", h = TRUE)
View(pgc_scz_full_2012_04)
View(TG_ONE_Eur_tbl)
filter_pvals <- TG_ONE_Eur_tbl$GC.Pvalue[pmatch(commonSnp, TG_ONE_Eur_tbl$MarkerName)]
commonSnp <- intersect(TG_ONE_Eur_tbl$MarkerName, pgc_scz_full_2012_04$snpid)
filter_pvals <- TG_ONE_Eur_tbl$GC.Pvalue[pmatch(commonSnp, TG_ONE_Eur_tbl$MarkerName)]
pvals <- pgc_scz_full_2012_04$pval[pmatch(commonSnp, pgc_scz_full_2012_04$snpid)]
filters <- qnorm(filter_pvals/2, lower.tail = FALSE)
lipid_res <- empOPW(pvalue = pvals, filter = filters, alpha = alpha, tail = 2,
delInterval = .01, max.group = 100,
effectType = "binary", method = "BON")
lipid_res$rejections
alpha = .1
lipid_res <- empOPW(pvalue = pvals, filter = filters, alpha = alpha, tail = 2,
delInterval = .01, max.group = 100,
effectType = "binary", method = "BON")
lipid_res$rejections
lipid_res$opGroup
lipid_res <- empOPW(pvalue = pvals, filter = filters, alpha = alpha, tail = 2,
delInterval = .01, max.group = 100,
effectType = "binary", method = "BH")
lipid_res$rejections
lipid_res$opGroup
f
zscores <- filters
m = length(pvals)
dbn_wgt <- bayes_weights(mu = zscores, sigma = rep(1, m), q = alpha/m)$w
sum(dbn_wgt)
m
rej_dbn <- sum(pvals <= alpha*dbn_wgt/m, na.rm = TRUE)
rej_dbn_bh <- sum(p.adjust(pvals/dbn_wgt, method = "BH") <= alpha, na.rm = TRUE)
rej_dbn
rej_dbn_bh
setwd("U:/Documents/My Research (UGA)/Multiple Hypoetheses/Article-2/Data")
library(readr)
library(readr)
CKDGen_eGFRcrea_meta_post <- read_csv("U:/Documents/My Research (UGA)/Multiple Hypoetheses/Article-2/Data/CKDGen-eGFRcrea_meta_post.csv")
View(CKDGen_eGFRcrea_meta_post)
library(readr)
C4D_CAD_DISCOVERY_METAANALYSIS_UPDATE <- read_delim("U:/Documents/My Research (UGA)/Multiple Hypoetheses/Article-2/Data/C4D_CAD_DISCOVERY_METAANALYSIS_UPDATE.TXT",
"\t", escape_double = FALSE, trim_ws = TRUE)
View(C4D_CAD_DISCOVERY_METAANALYSIS_UPDATE)
CKDGen <- read_csv("CKDGen-eGFRcrea_meta_post.csv")
C4D_CAD <- read_delim("C4D_CAD_DISCOVERY_METAANALYSIS_UPDATE.TXT",
"\t", escape_double = FALSE, trim_ws = TRUE)
commonSnp <- intersect(C4D_CAD$SNP, CKDGen$rsID)
filter_pvals <- CKDGen$pval[pmatch(commonSnp, CKDGen$rsID)]
filter_pvals <- CKDGen$pval[pmatch(commonSnp, CKDGen$rsID)]
pvals <- C4D_CAD$PVALUE[pmatch(commonSnp, C4D_CAD$SNP)]
filters <- qnorm(filter_pvals/2, lower.tail = FALSE)
m = length(pvals)
m
lipid_res <- empOPW(pvalue = pvals, filter = filters, alpha = alpha, tail = 2,
delInterval = .01, max.group = 100,
effectType = "binary", method = "BH")
library(empOPW)
library(pweight)
library(IHW)
lipid_res <- empOPW(pvalue = pvals, filter = filters, alpha = alpha, tail = 2,
delInterval = .01, max.group = 100,
effectType = "binary", method = "BH")
alpha = .1
lipid_res <- empOPW(pvalue = pvals, filter = filters, alpha = alpha, tail = 2,
delInterval = .01, max.group = 100,
effectType = "binary", method = "BH")
lipid_res <- empOPW(pvalue = pvals, filter = filters, alpha = alpha, tail = 2,
delInterval = .01, max.group = 100,
effectType = "continuous", method = "BH")
lipid_res$rejections
lipid_res$opGroup
IHW <- ihw(pvals, filters, alpha = alpha)
rejections(IHW)
IHW <- ihw(pvals, filters, alpha = alpha, adjustment_type = "bonferroni")
rejections(IHW)
c4D_res <- empOPW(pvalue = pvals, filter = filters, alpha = alpha, tail = 2,
delInterval = .01, max.group = 100,
effectType = "continuous", method = "BON")
C4D_res$rejections
c4D_res$rejections
c4D_res$opGroup
zscores <- filters
dbn_wgt <- bayes_weights(mu = zscores, sigma = rep(1, m), q = alpha/m)$w
sum(dbn_wgt)
m
rej_dbn <- sum(pvals <= alpha*dbn_wgt/m, na.rm = TRUE)
rej_dbn_bh <- sum(p.adjust(pvals/dbn_wgt, method = "BH") <= alpha, na.rm = TRUE)
rej_dbn
rej_dbn_bh
BON <- sum(pvals <= alpha/length(pvals))
BH <- sum(p.adjust(pvals, method = "BH") <= alpha)
BH
BON
setwd("U:/Documents/My Research (UGA)/Multiple Hypoetheses/Article-2/Data")
library(OPWeight)
library(OPWpaper)
library(empOPW)
library(MASS)
library(qvalue)
library(limma)
library(splines)
library(DESeq2)
library(mvnfast)		# fast generate multi variate normal
library("IHW")		# independent hypothesis weight
library(ggplot2)
library(reshape2)
library(cowplot)
library(tibble)
x = 1:10
z=(x-mean(x))/sd(x)
z
(z-mean(z))/sd(z)
data_analysis <- function(alpha, pvalue, filters, N_current, N_prior, tail,
maxgroup, effectType = c("continuous", "binary"))
{
sigma <- sqrt(N_current/N_prior)
zscores <- (filters - mean(filters, na.rm = TRUE))/sd(filters, na.rm = TRUE)
dbn_wgt <- bayes_weights(mu = zscores, sigma = sigma, q = alpha/m)$w
# FWER cotrols-------
pro_bon <- empOPW(pvalue = pvalue, filter = filters, alpha = alpha,
tail = tail, max.group = maxgroup,
effectType = effectType, method = "BON")
bon <- sum(pvalue <= alpha/length(pvalue))
dbn_bon <- sum(pvalue <= alpha*dbn_wgt/m, na.rm = TRUE)
ihw_bon <- ihw(pvalue, filters, alpha = alpha, adjustment_type = "bonferroni")
# FDR controls-------
pro_bh <- empOPW(pvalue = pvalue, filter = filters, alpha = alpha,
tail = tail, max.group = maxgroup,
effectType = effectType, method = "BH")
bh <- sum(p.adjust(pvalue, method = "BH") <= alpha)
dbn_bh <- sum(p.adjust(pvalue/dbn_wgt, method = "BH") <= alpha, na.rm = TRUE)
ihw_bh <- ihw(pvalue, filters, alpha = alpha)
return(c(pro_bon, bon, dbn_bon, ihw_bon, pro_bh, bh, dbn_bh, ihw_bh))
}
library(readr)
TG_ONE_Eur_tbl <- read_delim("TG_ONE_Eur.tbl.sorted","\t", escape_double = FALSE, trim_ws = TRUE)
pgc_scz_full_2012_04 <- read.table("pgc.scz.full.2012-04.txt", h = TRUE)
alpha = .1
pvalue = pvals
filters = filters
commonSnp <- intersect(TG_ONE_Eur_tbl$MarkerName, pgc_scz_full_2012_04$snpid)
filter_pvals <- TG_ONE_Eur_tbl$GC.Pvalue[pmatch(commonSnp, TG_ONE_Eur_tbl$MarkerName)]
pvals <- pgc_scz_full_2012_04$pval[pmatch(commonSnp, pgc_scz_full_2012_04$snpid)]
filters <- qnorm(filter_pvals/2, lower.tail = FALSE)
pvalue = pvals
filters = filters
N_current = length(pvals)
N_prior = length(filters)
tail = 2
maxgroup = 100
effectType = "continuous"
m = length(pvalue)
m
N_current = m
N_prior = length(filters)
N_prior
N_current = dim(pgc_scz_full_2012_04)[1]
N_prior = dim(TG_ONE_Eur_tbl)[1]
N_current
N_prior
m = length(pvlaue)
m = length(pvalue)
m
sigma <- sqrt(N_current/N_prior)
sigma
z_prior<- (filters - mean(filters, na.rm = TRUE))/sd(filters, na.rm = TRUE)
mu <- sqrt(N_current/N_prior)*z_prior
dbn_wgt <- bayes_weights(mu = mu, sigma = sigma, q = alpha/m)$w
library(pweight)
library(readr)
dbn_wgt <- bayes_weights(mu = mu, sigma = sigma, q = alpha/m)$w
dbn_wgt
pro_bon <- empOPW(pvalue = pvalue, filter = filters, alpha = alpha,
tail = tail, max.group = maxgroup,
effectType = effectType, method = "BON")
bon <- sum(pvalue <= alpha/length(pvalue))
dbn_bon <- sum(pvalue <= alpha*dbn_wgt/m, na.rm = TRUE)
ihw_bon <- ihw(pvalue, filters, alpha = alpha, adjustment_type = "bonferroni")
pro_bh <- empOPW(pvalue = pvalue, filter = filters, alpha = alpha,
tail = tail, max.group = maxgroup,
effectType = effectType, method = "BH")
bh <- sum(p.adjust(pvalue, method = "BH") <= alpha)
dbn_bh <- sum(p.adjust(pvalue/dbn_wgt, method = "BH") <= alpha, na.rm = TRUE)
ihw_bh <- ihw(pvalue, filters, alpha = alpha)
c(pro_bon, bon, dbn_bon, ihw_bon, pro_bh, bh, dbn_bh, ihw_bh)
data_analysis <- function(alpha, pvalue, filters, N_current, N_prior, tail,
maxgroup, effectType = c("continuous", "binary"))
{
m = length(pvalue)
sigma <- sqrt(N_current/N_prior)
z_prior<- (filters - mean(filters, na.rm = TRUE))/sd(filters, na.rm = TRUE)
mu <- sqrt(N_current/N_prior)*z_prior
dbn_wgt <- bayes_weights(mu = mu, sigma = sigma, q = alpha/m)$w
# FWER cotrols-------
pro_bon <- empOPW(pvalue = pvalue, filter = filters, alpha = alpha,
tail = tail, max.group = maxgroup,
effectType = effectType, method = "BON")$rejections
bon <- sum(pvalue <= alpha/length(pvalue))
dbn_bon <- sum(pvalue <= alpha*dbn_wgt/m, na.rm = TRUE)
ihw_bon <- rejections(ihw(pvalue, filters, alpha = alpha,
adjustment_type = "bonferroni"))
# FDR controls-------
pro_bh <- empOPW(pvalue = pvalue, filter = filters, alpha = alpha,
tail = tail, max.group = maxgroup,
effectType = effectType, method = "BH")$rejections
bh <- sum(p.adjust(pvalue, method = "BH") <= alpha)
dbn_bh <- sum(p.adjust(pvalue/dbn_wgt, method = "BH") <= alpha, na.rm = TRUE)
ihw_bh <- rejections(ihw(pvalue, filters, alpha = alpha))
return(c(pro_bon, bon, dbn_bon, ihw_bon, pro_bh, bh, dbn_bh, ihw_bh))
}
data_analysis(alpha = .1, pvalue = pvals, filters = filters,
N_current = dim(pgc_scz_full_2012_04)[1],
N_prior = dim(TG_ONE_Eur_tbl)[1], tail = 2,
maxgroup = 100, effectType = "continuous")
rm(data_analysis())
rm(data_analysis)
library(empOPW)
data_analysis()
data_analysis
alphaVec <- seq(.05, .1, .02)
alphaVec
alphaVec <- seq(.05, .1, .01)
alphaVec
alphaVec <- seq(.05, .1, length.out = 5)
alphaVec
alphaVec <- seq(.05, .1, length.out = 5)
Lipid-SCZ_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = dim(pgc_scz_full_2012_04)[1], N_prior = dim(TG_ONE_Eur_tbl)[1],
tail = 2, max.group = 100, effectType = "continuous")
Lipid-SCZ_results
Lipid-SCZ_result
Lipid-SCZ_results
Lipid-SCZ_results
Lipid-SCZ_results <- sapply(.1, data_analysis, pvalue = pvals, filter = filters,
N_current = dim(pgc_scz_full_2012_04)[1], N_prior = dim(TG_ONE_Eur_tbl)[1],
tail = 2, max.group = 100, effectType = "continuous")
rm(list=ls())
m = 10000
X = runif(m, min = 0, max = 2.5)               # covariate
H = rbinom(length(X), size = 1, prob = 0.1)   # hypothesis true or false
Z = rnorm(length(X), mean = H * X)            # Z-score
p = 1 - pnorm(Z)
rejections <- data_analysis(alpha = .1, pvalue = p, filter = X, N_current = m,
N_prior = m, tail = 2, max.group = 10, effectType = "continuous")
rejections
bottomly_count_table <- read.table("bottomly_count_table.txt",h=T)
bottomly_phenodata <- read.table("bottomly_phenodata.txt",h=T)
countData <- as.matrix(bottomly_count_table[,-1])		# counts
condition <- factor(bottomly_phenodata[,3])				# strain as factor
dds <- DESeqDataSetFromMatrix(countData, DataFrame(condition), ~ condition)
dds <- DESeq(dds)
bottomly <- results(dds)
colnames(bottomly)
library(DESeq)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData, DataFrame(condition), ~ condition)
install.packages("checkmate")
dds <- DESeqDataSetFromMatrix(countData, DataFrame(condition), ~ condition)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData, DataFrame(condition), ~ condition)
dds <- DESeq(dds)
bottomly <- results(dds)
colnames(bottomly)
pvals = bottomly$pvalue
filters = bottomly$baseMean
m = length(pvals)
alphaVec <- seq(.05, .1, length.out = 5)
bottomly_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 100, effectType = "continuous")
bottomly_results
pvalue = pvals
filter = filters
N_current = m
N_prior = m
tail = 2
max.group = 100
effectType = "continuous"
m = length(pvalue)
sigma <- sqrt(N_current/N_prior)
z_prior<- (filter - mean(filter, na.rm = TRUE))/sd(filter, na.rm = TRUE)
mu <- sqrt(N_current/N_prior)*z_prior
dbn_wgt <- bayes_weights(mu = mu, sigma = sigma, q = alpha/m)$w
alpha=.05
dbn_wgt <- bayes_weights(mu = mu, sigma = sigma, q = alpha/m)$w
pro_bon <- empOPW(pvalue = pvalue, filter = filter, alpha = alpha,
tail = tail, max.group = max.group,
effectType = effectType, method = "BON")$rejections
pro_bon
bon <- sum(pvalue <= alpha/length(pvalue))
bon
bon <- sum(pvalue <= alpha/length(pvalue), na.rm = TRUE)
bon
dbn_bon <- sum(pvalue <= alpha*dbn_wgt/m, na.rm = TRUE)
dbn_bon
dbn_bon
ihw_bon <- rejections(ihw(pvalue, filter, alpha = alpha,
adjustment_type = "bonferroni"))
ihw_bon
pro_bh <- empOPW(pvalue = pvalue, filter = filter, alpha = alpha,
tail = tail, max.group = max.group,
effectType = effectType, method = "BH")$rejections
pro_bh
bh <- sum(p.adjust(pvalue, method = "BH") <= alpha)
bh
bh <- sum(p.adjust(pvalue, method = "BH") <= alpha, na.rm = TRUE)
bh
dbn_bh <- sum(p.adjust(pvalue/dbn_wgt, method = "BH") <= alpha, na.rm = TRUE)
ihw_bh <- rejections(ihw(pvalue, filter, alpha = alpha))
dbn_bh
ihw_bh
library(empOPW)
alphaVec <- seq(.05, .1, length.out = 5)
bottomly_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 100, effectType = "continuous")
bottomly_results
rejections=bottomly_results
rownames(rejections) <- c('pro_bon', 'bon', 'dbn_bon', 'ihw_bon',
'pro_bh', 'bh', 'dbn_bh', 'ihw_bh')
rejections
colnames(rejections) <- paste("alpha", seq(.05, .1, length = 5))
rejections
colnames(rejections) <- paste0("alpha", seq(.05, .1, length = 5))
rejections
library(empOPW)
?sapply
data_analysis
library(empOPW)
alphaVec <- seq(.05, .1, length.out = 2)
bottomly_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 100, effectType = "continuous")
bottomly_results
bottomly_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 100, effectType = "continuous", simplify = FALSE)
bottomly_results
bottomly_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 100, effectType = "continuous", USE.NAMES = FALSE)
bottomly_results
alphaVec <- seq(.05, .1, length.out = 5)
bottomly_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 100, effectType = "continuous")
library(empOPW)
bottomly_results
proteomics_file <- system.file("extdata/real_data","science_signaling.csv",
package = "IHWpaper")
proteomics_df <- read.csv(proteomics_file, stringsAsFactors = F)
proteomics_df$pvalue <- rank(proteomics_df$p1, ties.method="first")*proteomics_df$p1/nrow(proteomics_df)
proteomics_df$test = qnorm(proteomics_df$pvalue, lower.tail = F)
names(proteomics_df)
pvals = proteomics_df$pvalue
filters = proteomics_df$X..peptides
m = length(pvals)
alphaVec <- seq(.05, .1, length.out = 5)
proteomics_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 100, effectType = "continuous")
proteomics_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 10, effectType = "continuous")
proteomics_results
rm(list=ls())
load(system.file("extdata/real_data", "hammer_eset.RData", package = "IHWpaper"),
envir=environment())
countData <- exprs(hammer.eset)
colData <- pData(hammer.eset)
dds <- DESeqDataSetFromMatrix(countData = countData, colData = colData , design = ~protocol)
dds <- dds[, dds$Time == "2 months"]
dds <- DESeq(dds)
de_res_ham <- results(dds)
colnames(de_res_ham)
dim(de_res_ham)
filters = de_res_ham$baseMean
pvals <- de_res_ham$pvalue
m = length(pvals)
alphaVec <- seq(.05, .1, length.out = 5)
hammer_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 100, effectType = "continuous")
hammer_results
rm(list=ls())
library("pasilla")
data("pasillaGenes", package="pasilla")
countData <- counts(pasillaGenes)
colData <- pData(pasillaGenes)[,c("condition","type")]
dds <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~ condition)
dds <- DESeqDataSet(se = pasillaGenes, design = ~ cell + dex)
dds <- DESeqDataSet(se = pasillaGenes, design = ~ cell + dex)
dds <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~ condition)
de_res_pas <- results(dds)
colnames(de_res_pas)
dim(de_res_pas)
dds <- DESeq(dds)
colData <- pData(pasillaGenes)[,c("condition","type")]
dds <- DESeqDataSetFromMatrix(countData = countData,
colData = colData,
design = ~ condition)
dds <- DESeq(dds)
de_res_pas <- results(dds)
colnames(de_res_pas)
dim(de_res_pas)
filters = de_res_pas$baseMean
pvals <- de_res_pas$pvalue
m = length(pvals)
alphaVec <- seq(.05, .1, length.out = 5)
pasilla_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 100, effectType = "continuous")
pasilla_results
rm(list=ls())
data("airway", package = "airway")
dds <- DESeqDataSet(se = airway, design = ~ cell + dex)
dds <- DESeq(dds)
de_res_air <- results(dds)
colnames(de_res_air)
dim(de_res_air)
filters = de_res_air$baseMean
pvals <- de_res_air$pvalue
m = length(pvals)
alphaVec <- seq(.05, .1, length.out = 5)
airway_results <- sapply(alphaVec, data_analysis, pvalue = pvals, filter = filters,
N_current = m, N_prior = m,
tail = 2, max.group = 100, effectType = "continuous")
airway_results
library(empOPW)
