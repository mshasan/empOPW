library(empOPW)
library(OPWeight)
library(OPWpaper)
library(empOPW)
library(MASS)
library(qvalue)
library(limma)
library(splines)
library(DESeq2)
#install.packages("mvnfast")
library(mvnfast)		# fast generate multi variate normal
#source("https://bioconductor.org/biocLite.R")
#biocLite("IHW")
library("IHW")		# independent hypotheis weight
library(ggplot2)
library(reshape2)
library(cowplot)
library(tibble)
m <- 10000
null = .8
set.seed(123)
filters <- runif(m, min = 0, max = 3)          # covariate
H <- rbinom(m, size = 1, prob = 1 - null)      # alternative hypothesis true or false
tests <- rnorm(m, mean = H*filters)            # Z-score
pvals <- pnorm(tests, lower.tail = FALSE)
Data <- tibble(pvals, filters)
# dist. of alp-values-------
hist_pval <- ggplot(Data, aes_string(x = Data$pvals)) +
geom_histogram(colour = "#1F9553", fill = "#4281AE", binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
# ordered by covariate---------
OD <- Data[order(filters, decreasing = TRUE), ]
OD_pavlue <- OD$pvals
# dist of five groups p-values-----------
grpSize = 2000
g <- list()
for(j in 1:5)
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- c(rep("red2", 1), rep("#4281AE", 39))
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = pvalPerGrp)) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[2]], g[[3]], g[[4]], g[[5]],
labels = letters[1:6], ncol = 3)
p
ranksProb1 = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 5,
h_breaks = 41, bin_idx = 1, effectType = "continuous")
plot(1:5, ranksProb1, type="l", xlab = "ranks", ylab = "P(rank | effect)")
par(mfrow=c(2,4))
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 5,
h_breaks = 41, bin_idx = 1, effectType = "continuous")
plot(1:5, ranksProb, type="l", xlab = "ranks", ylab = "P(rank | effect)")
}
# ranks proabilities of the different effect sizes---------
par(mfrow=c(2,4))
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 5,
h_breaks = 41, bin_idx = i, effectType = "continuous")
plot(1:5, ranksProb, type="l", xlab = "ranks", ylab = "P(rank | effect)")
}
m <- 100000
null = .8
set.seed(123)
filters <- runif(m, min = 0, max = 3)          # covariate
H <- rbinom(m, size = 1, prob = 1 - null)      # alternative hypothesis true or false
tests <- rnorm(m, mean = H*filters)            # Z-score
pvals <- pnorm(tests, lower.tail = FALSE)
Data <- tibble(pvals, filters)
# dist. of all p-values-------
hist_pval <- ggplot(Data, aes_string(x = Data$pvals)) +
geom_histogram(colour = "#1F9553", fill = "#4281AE", binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
# ordered by covariate---------
OD <- Data[order(filters, decreasing = TRUE), ]
OD_pavlue <- OD$pvals
# dist of five groups p-values-----------
grpSize = 1000
g <- list()
for(j in 1:5)
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- c(rep("red2", 1), rep("#4281AE", 39))
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = pvalPerGrp)) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[2]], g[[3]], g[[4]], g[[5]],
labels = letters[1:6], ncol = 3)
# dist of five groups p-values-----------
grpSize = 1000
g <- list()
for(j in c(1, 5, 15, 25, 50, 75, 100))
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- c(rep("red2", 1), rep("#4281AE", 39))
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = pvalPerGrp)) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[2]], g[[3]], g[[4]], g[[5]], g[[6]], g[[7]]
labels = letters[1:6], ncol = 3)
p <- plot_grid(hist_pval, g[[1]], g[[2]], g[[3]], g[[4]], g[[5]], g[[6]], g[[7]]
labels = letters[1:8], ncol = 4)
p <- plot_grid(hist_pval, g[[1]], g[[2]], g[[3]], g[[4]], g[[5]], g[[6]], g[[7]],
labels = letters[1:8], ncol = 4)
p
# dist of five groups p-values-----------
grpSize = 1000
g <- list()
for(j in c(1, 5, 15, 25, 50, 75, 100))
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- c(rep("red2", 1), rep("#4281AE", 39))
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = pvalPerGrp)) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[2]], g[[3]], g[[4]], g[[5]], g[[6]], g[[7]],
labels = letters[1:8], ncol = 4)
p
dim(Data)
# dist. of all p-values-------
hist_pval <- ggplot(Data, aes_string(x = Data$pvals)) +
geom_histogram(colour = "#1F9553", fill = "#4281AE", binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
# ordered by covariate---------
OD <- Data[order(filters, decreasing = TRUE), ]
OD_pavlue <- OD$pvals
# dist of five groups p-values-----------
grpSize = 1000
g <- list()
for(j in c(1, 5, 15, 25, 50, 75, 100))
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- c(rep("red2", 1), rep("#4281AE", 39))
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = pvalPerGrp)) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[2]], g[[3]], g[[4]], g[[5]], g[[6]], g[[7]],
labels = letters[1:8], ncol = 4)
p
g[[1]]
g[[2]]
p <- plot_grid(hist_pval, g[[1]], g[[5]], g[[15]], g[[25]], g[[50]], g[[75]], g[[100]],
labels = letters[1:8], ncol = 4)
p
# ranks proabilities of the different effect sizes---------
par(mfrow=c(2,4))
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 100,
h_breaks = 41, bin_idx = i, effectType = "continuous")
plot(1:100, ranksProb, type="l", xlab = "ranks", ylab = "P(rank | effect)")
}
ranksProb
library(empOPW)
prob_rank_givenEffect_emp
# ranks proabilities of the different effect sizes---------
par(mfrow=c(2,4))
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 100,
h_breaks = 41, bin_idx = i, smooth=FALSE, effectType = "continuous")
plot(1:100, ranksProb, type="l", xlab = "ranks", ylab = "P(rank | effect)")
}
# ranks proabilities of the different effect sizes---------
par(mfrow=c(2,4))
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 100,
h_breaks = 41, bin_idx = i, effectType = "continuous")
plot(1:100, ranksProb, type="l", xlab = "ranks", ylab = "P(rank | effect)")
}
ranksProb <- data.frame(ranksProb)
ranksProb_dat <- data.frame(ranks = 1:100, ranksProb)
ranksProb_dat
# ranks proabilities of the different effect sizes---------
g_prob <- list()
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 100,
h_breaks = 41, bin_idx = i, effectType = "continuous")
ranksProb_dat <- data.frame(ranks = 1:100, ranksProb)
g_prob[[i]] <- ggplot(ranksProb_dat, aes(x = ranks, y = ranksProb)) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
}
# ranks proabilities of the different effect sizes---------
g_prob <- list()
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 100,
h_breaks = 41, bin_idx = i, effectType = "continuous")
ranksProb_dat <- data.frame(ranks = 1:100, ranksProb)
g_prob[[i]] <- ggplot(ranksProb_dat, aes(x = ranks, y = ranksProb)) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
}
p_prob <- plot_grid(g_prob[[1]], g_prob[[2]], g_prob[[3]], g_prob[[5]],
g_prob[[10]], g_prob[[20]], g_prob[[40]],
labels = letters[1:7], ncol = 4)
p_prob
ranksProb_bin = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters,
group = 100, effectType = "binary")
ranksProb_bin_dat <- data.frame(ranks = 1:100, ranksProb_bin)
g_prob_bin <- ggplot(ranksProb_bin_dat, aes(x = ranks, y = ranksProb)) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
p_prob <- plot_grid(g_prob[[1]], g_prob[[2]], g_prob[[3]], g_prob[[5]],
g_prob[[10]], g_prob[[20]], g_prob[[40]], g_prob_bin,
labels = letters[1:8], ncol = 4)
p_prob
ranksProb_bin
ranksProb_bin_dat
g_prob_bin
ranksProb_bin = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters,
group = 100, effectType = "binary")
ranksProb_bin_dat <- data.frame(ranks = 1:100, ranksProb_bin)
g_prob_bin <- ggplot(ranksProb_bin_dat, aes_string(x = "ranks", y = "ranksProb_bin")) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
p_prob <- plot_grid(g_prob[[1]], g_prob[[2]], g_prob[[3]], g_prob[[5]],
g_prob[[10]], g_prob[[20]], g_prob[[40]], g_prob_bin,
labels = letters[1:8], ncol = 4)
p_prob
# ranks proabilities of the different effect sizes---------
g_prob <- list()
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 100,
h_breaks = 41, bin_idx = i, effectType = "continuous")
ranksProb_dat <- data.frame(ranks = 1:100, ranksProb)
g_prob[[i]] <- ggplot(ranksProb_dat, aes_string(x = "ranks", y = "ranksProb")) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
}
ranksProb_bin = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters,
group = 100, effectType = "binary")
ranksProb_bin_dat <- data.frame(ranks = 1:100, ranksProb_bin)
g_prob_bin <- ggplot(ranksProb_bin_dat, aes_string(x = "ranks", y = "ranksProb_bin")) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
p_prob <- plot_grid(g_prob[[1]], g_prob[[2]], g_prob[[3]], g_prob[[5]],
g_prob[[10]], g_prob[[20]], g_prob[[40]], g_prob_bin,
labels = letters[1:8], ncol = 4)
# dist. of all p-values-------
hist_pval <- ggplot(Data, aes_string(x = "pvals")) +
geom_histogram(colour = "#1F9553", fill = "#4281AE", binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
# ordered by covariate---------
OD <- Data[order(filters, decreasing = TRUE), ]
OD_pavlue <- OD$pvals
# dist of five groups p-values-----------
grpSize = 1000
g <- list()
for(j in c(1, 5, 15, 25, 50, 75, 100))
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- c(rep("red2", 1), rep("#4281AE", 39))
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = "pvalPerGrp")) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[5]], g[[15]], g[[25]], g[[50]], g[[75]], g[[100]],
labels = letters[1:8], ncol = 4)
# ranks proabilities of the different effect sizes---------
g_prob <- list()
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 100,
h_breaks = 41, bin_idx = i, effectType = "continuous")
ranksProb_dat <- data.frame(ranks = 1:100, ranksProb)
g_prob[[i]] <- ggplot(ranksProb_dat, aes_string(x = "ranks", y = "ranksProb")) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
}
ranksProb_bin = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters,
group = 100, effectType = "binary")
ranksProb_bin_dat <- data.frame(ranks = 1:100, ranksProb_bin)
g_prob_bin <- ggplot(ranksProb_bin_dat, aes_string(x = "ranks", y = "ranksProb_bin")) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
p_prob <- plot_grid(g_prob[[1]], g_prob[[2]], g_prob[[3]], g_prob[[5]],
g_prob[[10]], g_prob[[20]], g_prob[[40]], g_prob_bin,
labels = letters[1:8], ncol = 4)
p
p_prob
library(OPWeight)
library(OPWpaper)
library(empOPW)
library(MASS)
library(qvalue)
library(limma)
library(splines)
library(DESeq2)
#install.packages("mvnfast")
library(mvnfast)		# fast generate multi variate normal
#source("https://bioconductor.org/biocLite.R")
#biocLite("IHW")
library("IHW")		# independent hypotheis weight
library(ggplot2)
library(reshape2)
library(cowplot)
library(tibble)
# continuous case
# data generating
#===============================================================================
m <- 100000
null = .8
set.seed(123)
filters <- runif(m, min = 0, max = 3)          # covariate
H <- rbinom(m, size = 1, prob = 1 - null)      # alternative hypothesis true or false
tests <- rnorm(m, mean = H*filters)            # Z-score
pvals <- pnorm(tests, lower.tail = FALSE)
Data <- tibble(pvals, filters)
# dist. of all p-values-------
hist_pval <- ggplot(Data, aes_string(x = "pvals")) +
geom_histogram(colour = "#1F9553", fill = "#4281AE", binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
# ordered by covariate---------
OD <- Data[order(filters, decreasing = TRUE), ]
OD_pavlue <- OD$pvals
# dist of five groups p-values-----------
grpSize = 1000
g <- list()
for(j in c(1, 5, 15, 25, 50, 75, 100))
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- c(rep("red2", 1), rep("#4281AE", 39))
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = "pvalPerGrp")) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[5]], g[[15]], g[[25]], g[[50]], g[[75]], g[[100]],
labels = letters[1:8], ncol = 4)
# ranks proabilities of the different effect sizes---------
g_prob <- list()
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 100,
h_breaks = 41, bin_idx = i, effectType = "continuous")
ranksProb_dat <- data.frame(ranks = 1:100, ranksProb)
g_prob[[i]] <- ggplot(ranksProb_dat, aes_string(x = "ranks", y = "ranksProb")) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
}
ranksProb_bin = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters,
group = 100, effectType = "binary")
ranksProb_bin_dat <- data.frame(ranks = 1:100, ranksProb_bin)
g_prob_bin <- ggplot(ranksProb_bin_dat, aes_string(x = "ranks", y = "ranksProb_bin")) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
p_prob <- plot_grid(g_prob[[1]], g_prob[[2]], g_prob[[3]], g_prob[[5]],
g_prob[[10]], g_prob[[20]], g_prob[[40]], g_prob_bin,
labels = letters[1:8], ncol = 4)
p
# ranks proabilities of the different effect sizes---------
g_prob <- list()
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 100,
h_breaks = 41, bin_idx = i, effectType = "continuous")
ranksProb_dat <- data.frame(ranks = 1:100, ranksProb)
g_prob[[i]] <- ggplot(ranksProb_dat, aes_string(x = "ranks", y = "ranksProb")) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
}
source("https://bioconductor.org/biocLite.R")
biocLite("OPWeight")
library(devtools)
install_github("mshasan/empOPW")
library(empOPW)
# ranks proabilities of the different effect sizes---------
g_prob <- list()
for(i in c(1, 2, 3, 5, 10, 20, 40))
{
ranksProb = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters, group = 100,
h_breaks = 41, bin_idx = i, effectType = "continuous")
ranksProb_dat <- data.frame(ranks = 1:100, ranksProb)
g_prob[[i]] <- ggplot(ranksProb_dat, aes_string(x = "ranks", y = "ranksProb")) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
}
ranksProb_bin = prob_rank_givenEffect_emp(pvalue = pvals, filter = filters,
group = 100, effectType = "binary")
ranksProb_bin_dat <- data.frame(ranks = 1:100, ranksProb_bin)
g_prob_bin <- ggplot(ranksProb_bin_dat, aes_string(x = "ranks", y = "ranksProb_bin")) +
geom_line(size = 1.5, col="firebrick4") +
labs(x = "Test rank" , y = "p(rank | effect)")
p_prob <- plot_grid(g_prob[[1]], g_prob[[2]], g_prob[[3]], g_prob[[5]],
g_prob[[10]], g_prob[[20]], g_prob[[40]], g_prob_bin,
labels = letters[1:8], ncol = 4)
p_prob
# dist of five groups p-values-----------
grpSize = 1000
g <- list()
for(j in c(1, 5, 15, 25, 50, 75, 100))
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- rep("#4281AE", 40)
colors[c(1, 2, 3, 5, 10, 20, 40)] <- c("red2","orangered2", "orange4", "gold4",
"khaki3", "sienna3", "yello4")
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = "pvalPerGrp")) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[5]], g[[15]], g[[25]], g[[50]], g[[75]], g[[100]],
labels = letters[1:8], ncol = 4)
# dist of five groups p-values-----------
grpSize = 1000
g <- list()
for(j in c(1, 5, 15, 25, 50, 75, 100))
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- rep("#4281AE", 40)
colors[c(1, 2, 3, 5, 10, 20, 40)] <- c("red2","orangered2", "orange4", "gold4",
"khaki3", "sienna3", "yellow4")
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = "pvalPerGrp")) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[5]], g[[15]], g[[25]], g[[50]], g[[75]], g[[100]],
labels = letters[1:8], ncol = 4)
p
hist_pval <- ggplot(Data, aes_string(x = "pvals")) +
geom_histogram(colour = "#1F9553", fill = "#4281AE", binwidth = 0.05,
boundary = 0) +
labs(x = "P-values")
# ordered by covariate---------
OD <- Data[order(filters, decreasing = TRUE), ]
OD_pavlue <- OD$pvals
grpSize = 1000
g <- list()
for(j in c(1, 5, 15, 25, 50, 75, 100))
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- rep("#4281AE", 20)
colors[c(1, 2, 3, 5, 10, 15, 20)] <- c("red2","orangered2", "orange4", "gold4",
"khaki3", "sienna3", "yellow4")
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = "pvalPerGrp")) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[5]], g[[15]], g[[25]], g[[50]], g[[75]], g[[100]],
labels = letters[1:8], ncol = 4)
# dist of five groups p-values-----------
grpSize = 1000
g <- list()
for(j in c(1, 5, 15, 25, 50, 75, 100))
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- rep("#4281AE", 20)
colors[c(1, 2, 3, 5, 10, 15, 20)] <- c("red2","orangered2", "orange4", "gold4",
"khaki3", "sienna3", "yellow4")
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = "pvalPerGrp")) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.025,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[5]], g[[15]], g[[25]], g[[50]], g[[75]], g[[100]],
labels = letters[1:8], ncol = 4)
pvalPerGrp
# dist of five groups p-values-----------
grpSize = 1000
g <- list()
for(j in c(1, 5, 15, 25, 50, 75, 100))
{
pvalPerGrp <- OD_pavlue[(j*grpSize - grpSize + 1):(j*grpSize)]
pvalPerGrp_dat <- data.frame(pvalPerGrp)
colors <- rep("#4281AE", 20)
colors[c(1, 2, 3, 5, 10, 15, 20)] <- c("red2","orangered2", "orange4", "gold4",
"khaki3", "sienna3", "yellow4")
g[[j]] <- ggplot(pvalPerGrp_dat, aes_string(x = "pvalPerGrp")) +
geom_histogram(colour = "#1F3553", fill = colors, binwidth = 0.05,
boundary = 0) +
labs(x = "P-values")
}
p <- plot_grid(hist_pval, g[[1]], g[[5]], g[[15]], g[[25]], g[[50]], g[[75]], g[[100]],
labels = letters[1:8], ncol = 4)
p
